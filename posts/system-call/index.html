<!DOCTYPE html><html lang="kr" data-mode="light" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="System call" /><meta property="og:locale" content="kr" /><meta name="description" content="무엇을 공부해할지 오래 헤맸다. 주니어인 지금 운영체제, 네트워크, 데이터베이스 이론을 제대로 공부하면 앞으로의 개발이 편해질 것이란 결론이 나왔다. 우선 Operating Systems: Three Easy Pieces를 보며 공부하는 중이다. (과제 깃)" /><meta property="og:description" content="무엇을 공부해할지 오래 헤맸다. 주니어인 지금 운영체제, 네트워크, 데이터베이스 이론을 제대로 공부하면 앞으로의 개발이 편해질 것이란 결론이 나왔다. 우선 Operating Systems: Three Easy Pieces를 보며 공부하는 중이다. (과제 깃)" /><link rel="canonical" href="https://younghch.github.io/posts/system-call/" /><meta property="og:url" content="https://younghch.github.io/posts/system-call/" /><meta property="og:site_name" content="Younghch" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-05-03T14:00:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="System call" /><meta name="twitter:site" content="@twitter_username" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-05-03T14:00:00+09:00","datePublished":"2022-05-03T14:00:00+09:00","description":"무엇을 공부해할지 오래 헤맸다. 주니어인 지금 운영체제, 네트워크, 데이터베이스 이론을 제대로 공부하면 앞으로의 개발이 편해질 것이란 결론이 나왔다. 우선 Operating Systems: Three Easy Pieces를 보며 공부하는 중이다. (과제 깃)","headline":"System call","mainEntityOfPage":{"@type":"WebPage","@id":"https://younghch.github.io/posts/system-call/"},"url":"https://younghch.github.io/posts/system-call/"}</script><title>System call | Younghch</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Younghch"><meta name="application-name" content="Younghch"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" https://avatars.githubusercontent.com/u/53392103?s=96&v=4 " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Younghch</a></div><div class="site-subtitle font-italic">개발 기록</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/younghch" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://www.linkedin.com/in/%EC%9A%A9%ED%9B%88-%EC%A1%B0-b18471193/" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['younghch42','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>System call</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>System call</h1><div class="post-meta text-muted"><div> By <em> <a href="https://github.com/younghch">Younghoun Cho</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1651554000" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-05-03 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="595 words"> <em>3 min</em> read</span></div></div></div><div class="post-content"><p>무엇을 공부해할지 오래 헤맸다. 주니어인 지금 운영체제, 네트워크, 데이터베이스 이론을 제대로 공부하면 앞으로의 개발이 편해질 것이란 결론이 나왔다. 우선 <a href="https://pages.cs.wisc.edu/~remzi/OSTEP/">Operating Systems: Three Easy Pieces</a>를 보며 공부하는 중이다. (<a href="https://github.com/younghch/operating-system-three-easy-pieces-homework">과제 깃</a>)</p><h2 id="what-is-system-call"><span class="mr-2">What is System Call?</span><a href="#what-is-system-call" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>cpu는 두가지 processor mode를 가진다. OS가 컨트롤을 가지는 kernel mode에서는 기능이 제한되지 않지만 프로세스가 실행되는 user mode에서는 보안을 위해 시스템에 영향을 줄 수 있는 기능이 제한된다. user mode에서도 제한된 기능을 사용할 수 있도록 제공되는 기능이 system call이다. 즉 프로세스가 OS에 컨트롤을 넘기고 결과를 돌려받는 것이다.</p><h2 id="trap-trap-table-trap-handler"><span class="mr-2">Trap, Trap table, Trap handler</span><a href="#trap-trap-table-trap-handler" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>trap은 user mode에서 kernel mode로 전환시킨다. kernel mode에서 프로그램의 어떤 코드라도 실행 가능하다면 보안에 치명적일 것이다. 이를 방지하기 위해 trap table이 존재하고 프로세스가 요청할 수 있는 기능이 제한된다. system call이 요청되면 OS는 system-call number에 맞는 trap handler를 trap table내에서 찾아 실행시킨다.</p><h2 id="procedure-of-system-call"><span class="mr-2">Procedure of system call</span><a href="#procedure-of-system-call" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><h3 id="brief-process"><span class="mr-2">Brief process</span><a href="#brief-process" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><ol><li>trap instruction이 실행되며 user mode에서 kernel mode로 전환된다. 실행되고 있는 프로그램이 return-from-trap 후에 다시 정상적으로 실행될 수 있도록 PC, 레지스터 정보가 kernel stack에 저장된다.<li>syscall이 실행된다.<li>return-from-trap이 실행된다. kernel stack에 넣은 값을 복구하고 user mode에서 PC의 다음 명렬을 수행한다.</ol><h3 id="timeline"><span class="mr-2">Timeline</span><a href="#timeline" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><div class="table-wrapper"><table><thead><tr><th>OS(kernel mode)<th>Hardware<th>Program(user mode)<tbody><tr><td><strong>boot</strong><td> <td> <tr><td>Initialize trap table<td> <td> <tr><td> <td>remember address of syscall handler<td> <tr><td><strong>run program</strong><td> <td> <tr><td>Create entry for process list <br /> Allocate memory for program<br /> Load program into memory<br /> Setup user stack with argv<br /> Fill kernel stack with reg/PC<td> <td> <tr><td><strong>return from trap</strong><td> <td> <tr><td> <td>restore regs from kernel stack<br /> move to user mode<br /> jump to main<td> <tr><td> <td> <td>Run main()<br /> execute instructions<br /> Call system call<tr><td> <td> <td><strong>trap into OS</strong><tr><td> <td>save regs to kernel stack<br /> move to kernel mode<br /> jump to trap handler<td> <tr><td>Handle trap<br /> do work of syscall<td> <td> <tr><td><strong>return from trap</strong><td> <td> <tr><td> <td>restore regs from kernel stack<br /> move to user mode<br /> jump to PC after trap<td> <tr><td> <td> <td>execute instructions<br /> exit()<tr><td> <td> <td><strong>trap</strong><tr><td>Free memory of processes<br /> Remove from process list<td> <td> </table></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/%EC%9A%B4%EC%98%81%EC%B2%B4%EC%A0%9C/'>운영체제</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/os/" class="post-tag no-text-decoration" >OS</a> <a href="/tags/system-call/" class="post-tag no-text-decoration" >system call</a> <a href="/tags/limited-direct-execution/" class="post-tag no-text-decoration" >limited direct execution</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=System call - Younghch&amp;url=https://younghch.github.io/posts/system-call/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=System call - Younghch&amp;u=https://younghch.github.io/posts/system-call/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://younghch.github.io/posts/system-call/&amp;text=System call - Younghch" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/apply-ddd-to-project/">DDD 사이드 프로젝트에 적용해보기(1)</a><li><a href="/posts/%EA%B0%9C%EB%B0%9C%EB%B8%94%EB%A1%9C%EA%B7%B8%EC%8B%9C%EC%9E%91/">개발블로그 시작</a><li><a href="/posts/where-to-verify-a-user/">어디서 토큰을 인증할 것인가?</a><li><a href="/posts/OAuth2.0/">OAuth2.0</a><li><a href="/posts/context-switch/">Context Switch</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/limited-direct-execution/">limited direct execution</a> <a class="post-tag" href="/tags/os/">OS</a> <a class="post-tag" href="/tags/api-gateway/">API Gateway</a> <a class="post-tag" href="/tags/aws/">AWS</a> <a class="post-tag" href="/tags/context-switch/">context switch</a> <a class="post-tag" href="/tags/ddd/">DDD</a> <a class="post-tag" href="/tags/domain-driven-design/">domain-driven design</a> <a class="post-tag" href="/tags/dynamic-programming/">dynamic programming</a> <a class="post-tag" href="/tags/ingresss-controller/">Ingresss Controller</a> <a class="post-tag" href="/tags/knapsack/">knapsack</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/context-switch/"><div class="card-body"> <em class="timeago small" data-ts="1651568400" > 2022-05-03 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Context Switch</h3><div class="text-muted small"><p> 프로세스가 cpu에서 실행되고 있을 때, OS는 실행되지 않는다. 그러면 어떻게 OS가 실행중인 프로세스를 다른 프로세스로 전환할까? Timer interrupt 프로세스에서 system call을 호출할때까지 기다려 OS가 컨트롤을 되찾을 수도 있지만, 프로그램이 무한 루프에 빠진다면 이를 되찾을 방법은 없다. 이에 하드웨어에서 타이머를 설정하고 ...</p></div></div></a></div><div class="card"> <a href="/posts/apply-ddd-to-project/"><div class="card-body"> <em class="timeago small" data-ts="1693659600" > 2023-09-02 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>DDD 사이드 프로젝트에 적용해보기(1)</h3><div class="text-muted small"><p> 사이드 프로젝트를 진행하면서 Implementing Domain-Driven Design을 읽고 있었다. 내용이 너무 커서 책을 읽는 속도가 프로젝트 진행속도에 따라가지 못했다. 이에 같은 저자의 가벼운 Domain-Driven Desiong Distlled를 읽고 프로젝트에 적용해보려고 한다. 바운디드 컨텍스트 정의 우리 프로젝트는 헬스 기록을 ...</p></div></div></a></div><div class="card"> <a href="/posts/where-to-verify-a-user/"><div class="card-body"> <em class="timeago small" data-ts="1691310600" > 2023-08-06 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>어디서 토큰을 인증할 것인가?</h3><div class="text-muted small"><p> 문제 상황 JWT을 사용하면 인증서버의 퍼블릭 키로 토큰을 검증 할 수 있다. 인증 코드 구현은 어렵지 않다. 하지만 모든 서버에 이 기능이 각각 추가되면 코드의 응집도를 떨어트린다. 인증서버와의 불필요한 통신이 없으면서 인증을 한곳에 응집시킬 방법은 어떤게 있을까? 환경 AWS 내 EKS사용 없이 직접 구성한 K8s 클러스터. 현재 S...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/%EB%83%85%EC%83%89%EB%AC%B8%EC%A0%9C/" class="btn btn-outline-primary" prompt="Older"><p>냅색 문제</p></a> <a href="/posts/context-switch/" class="btn btn-outline-primary" prompt="Newer"><p>Context Switch</p></a></div><div id="disqus_thread" class="pt-2 pb-2"><p class="text-center text-muted small"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script type="text/javascript"> var disqus_config = function () { this.page.url = 'https://younghch.github.io/posts/system-call/'; this.page.identifier = '/posts/system-call/'; }; /* Lazy loading */ var disqus_observer = new IntersectionObserver(function (entries) { if(entries[0].isIntersecting) { (function () { var d = document, s = d.createElement('script'); s.src = 'https://.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); disqus_observer.disconnect(); } }, { threshold: [0] }); disqus_observer.observe(document.querySelector('#disqus_thread')); /* Auto switch theme */ function reloadDisqus() { /* Disqus hasn't been loaded */ if (typeof DISQUS === "undefined") { return; } if (document.readyState == 'complete') { DISQUS.reset({ reload: true, config: disqus_config }); } } const modeToggle = document.querySelector(".mode-toggle"); if (typeof modeToggle !== "undefined") { /* modeToggle.addEventListener('click', reloadDisqus); // not pretty for 'color-scheme' */ window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', reloadDisqus); } </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://github.com/younghch">Younghoun Cho</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/limited-direct-execution/">limited direct execution</a> <a class="post-tag" href="/tags/os/">OS</a> <a class="post-tag" href="/tags/api-gateway/">API Gateway</a> <a class="post-tag" href="/tags/aws/">AWS</a> <a class="post-tag" href="/tags/context-switch/">context switch</a> <a class="post-tag" href="/tags/ddd/">DDD</a> <a class="post-tag" href="/tags/domain-driven-design/">domain-driven design</a> <a class="post-tag" href="/tags/dynamic-programming/">dynamic programming</a> <a class="post-tag" href="/tags/ingresss-controller/">Ingresss Controller</a> <a class="post-tag" href="/tags/knapsack/">knapsack</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/kr.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
